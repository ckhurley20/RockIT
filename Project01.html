<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Group project</title>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
</head>

<body>

    <style>
        .country-btn {
            width:14vw;
            font-size:2vw;
            border:none;
            margin:1.5vw;
            padding:2vw;
            background:#345;
            color:white;
            border-radius:15px;
        }
        #nav-mobile {
            display:flex;
        }
        .changeNow {
            border:none;
            border-radius:15px;
            margin-left:2vw;
            margin-top:.5vw;
        }

        #goodResults {
            font-size:16px;
            background:red;
            color:white;
        }

        
        

    </style>

        <nav class="blue" style="margin:0px">
            <div class="container blue darken-3">
                <div class="nav-wrapper">
                    <h5 class="brand-logo left hand-on-sm-and-down">Please enter a musical artist</h5>
                    <ul id="nav-mobile" class="right hand-on-med-and-down">
                        <input class="whatDoYouGot" type="text">
                        <input class="changeNow" type="submit" value="Submit">
                    </ul>
                </div>
            </div>
        </nav>

        
    
    

    <div id="countryList"></div>
    <div id="goodResults"></div>

    <script>

        var showList = [];

        $('.changeNow').on('click', function () {
            event.preventDefault();

            var userGuess = $('.whatDoYouGot').val().trim();
            $('#countryList').empty();
            $('#goodResults').empty();

            var queryURL = "https://rest.bandsintown.com/artists/" + userGuess + "/events?app_id=ac5d152e5bb85a812504fe7f16f5ff23";
            // console.log(queryURL);

            $.ajax({
                url: queryURL,
                method: "GET",

            }).then(function (response) {
                // console.log(response)
                showList = [];
                
                var countries = [];

                for(var j = 0; j < response.length; j++) {
                    if(countries.indexOf(response[j].venue.country) === -1) {
                        countries.push(response[j].venue.country)
                    }
                }
                showList = response
                console.log(showList);
                for(var k = 0; k < countries.length; k++) {
                    var $btn = $('<button>')
                        $btn.attr('data-country', countries[k])
                        $btn.text(countries[k])
                        $btn.addClass('country-btn')
                    $('#countryList').append($btn)
                }
            })
        })

        $(document).on('click', '.country-btn', function() {
            event.preventDefault();
            var country = $(this).data('country')
            var goodResults = [];
            

            

            for (var i = 0; i < showList.length; i++) {
                    if (showList[i].venue.country === country) {
                    goodResults.push(showList[i])
                    }   
                }
                // console.log(goodResults);

            for(var l = 0; l < goodResults.length; l++) {
                var $div = $('<div>')
                    $div.addClass('show-dtails')

                    var $description = $('<p>')
                        $description.text('Name: ' + goodResults[l].description)
                    var $lineUp = $('<p>')
                        $lineUp.text('Lineup: ' + goodResults[l].lineup)
                    var $dateTime = $('<p>')
                        $dateTime.text('Date: ' + goodResults[l].datetime)
                    var $venueName = $('<p>')
                        $venueName.text('Venue: ' + goodResults[l].venue.name)    

                    $div.append($description, $lineUp, $dateTime, $venueName)
                    $('#goodResults').append($div)


            }
        })





    </script>



</body>

</html>